<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Shield ‚Äî Security Dashboard</title>
    <link rel="stylesheet" href="dashboard.css" />
  </head>
  <body>
    <!-- Policy Acknowledgement Modal -->
    <div
      id="policy-modal"
      style="
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.5);
        z-index: 9999;
        align-items: center;
        justify-content: center;
      "
    >
      <div
        style="
          background: #fff;
          border-radius: 12px;
          max-width: 420px;
          width: 90vw;
          margin: auto;
          padding: 32px 24px;
          box-shadow: 0 8px 32px rgba(0, 0, 0, 0.18);
          text-align: center;
        "
      >
        <h2 style="margin-bottom: 18px">AI Usage Policy</h2>
        <div
          style="
            font-size: 14px;
            color: #333;
            margin-bottom: 22px;
            text-align: left;
          "
        >
          <p>
            <strong>Company Policy:</strong> Do not paste or enter sensitive,
            confidential, or personal data into unapproved AI tools. All usage
            is logged for compliance. Please review the full policy in your
            employee handbook.
          </p>
        </div>
        <button
          id="policy-agree-btn"
          style="
            background: #0071e3;
            color: #fff;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
          "
        >
          I Agree
        </button>
      </div>
    </div>
    <div class="dashboard">
      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <svg
            width="32"
            height="32"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#fff"
            stroke-width="2"
          >
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
          </svg>
          <h1>AI Shield</h1>
        </div>
        <nav class="sidebar-nav">
          <a href="#" class="nav-item active" data-tab="overview">
            <span class="nav-icon">üìä</span> Overview
          </a>
          <a href="#" class="nav-item" data-tab="monitoring">
            <span class="nav-icon">üõ°Ô∏è</span> Monitoring
          </a>
          <a href="#" class="nav-item" data-tab="logs">
            <span class="nav-icon">üìã</span> Activity Logs
          </a>
          <a href="#" class="nav-item" data-tab="settings">
            <span class="nav-icon">‚öôÔ∏è</span> Settings
          </a>
        </nav>
        <div class="sidebar-footer">
          <div class="user-info">
            <div class="user-avatar" id="sidebar-avatar">?</div>
            <div>
              <div class="user-name" id="sidebar-user-name">Loading...</div>
              <div class="user-role" id="sidebar-user-role">Employee</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-content">
        <!-- Overview Tab -->
        <section id="tab-overview" class="tab-content active">
          <div class="page-header">
            <h2>Security Overview</h2>
            <div class="header-actions">
              <select id="time-filter">
                <option value="today">Today</option>
                <option value="week">This Week</option>
                <option value="month">This Month</option>
                <option value="all">All Time</option>
              </select>
            </div>
          </div>

          <!-- Summary Cards -->
          <div class="summary-cards">
            <div class="summary-card card-blue">
              <div class="card-icon">üåê</div>
              <div class="card-data">
                <div class="card-number" id="total-visits">0</div>
                <div class="card-label">AI Domain Visits</div>
              </div>
            </div>
            <div class="summary-card card-orange">
              <div class="card-icon">‚ö†Ô∏è</div>
              <div class="card-data">
                <div class="card-number" id="total-warnings">0</div>
                <div class="card-label">Warnings Shown</div>
              </div>
            </div>
            <div class="summary-card card-green">
              <div class="card-icon">üîÄ</div>
              <div class="card-data">
                <div class="card-number" id="total-redirects">0</div>
                <div class="card-label">Users Redirected</div>
              </div>
            </div>
            <div class="summary-card card-red">
              <div class="card-icon">üìã</div>
              <div class="card-data">
                <div class="card-number" id="total-pastes">0</div>
                <div class="card-label">Paste Events</div>
              </div>
            </div>
            <div class="summary-card card-purple">
              <div class="card-icon">üö´</div>
              <div class="card-data">
                <div class="card-number" id="total-continued">0</div>
                <div class="card-label">Continued Anyway</div>
              </div>
            </div>
            <div class="summary-card card-teal">
              <div class="card-icon">üéØ</div>
              <div class="card-data">
                <div class="card-number" id="compliance-rate">0%</div>
                <div class="card-label">Compliance Rate</div>
              </div>
            </div>
            <div class="summary-card card-yellow">
              <div class="card-icon">üö®</div>
              <div class="card-data">
                <div class="card-number" id="total-sensitive">0</div>
                <div class="card-label">Sensitive Data Alerts</div>
              </div>
            </div>
          </div>

          <!-- Charts Section -->
          <div class="charts-row">
            <div class="chart-card">
              <h3>Top AI Tools Accessed</h3>
              <div id="top-tools-chart" class="chart-content"></div>
            </div>
            <div class="chart-card">
              <h3>Activity by Category</h3>
              <div id="category-chart" class="chart-content"></div>
            </div>
          </div>

          <!-- Recent Activity -->
          <div class="chart-card">
            <h3>Recent Activity</h3>
            <div id="recent-activity" class="activity-list"></div>
          </div>
        </section>

        <!-- Monitoring Tab (Manager Only) -->
        <section id="tab-monitoring" class="tab-content">
          <div class="page-header">
            <h2>Monitoring Levels</h2>
            <div id="monitoring-role-badge" class="role-badge"></div>
          </div>

          <!-- Non-manager notice -->
          <div
            id="monitoring-no-access"
            class="notice-card"
            style="display: none"
          >
            <span class="notice-icon">üîí</span>
            <div>
              <strong>Manager access required</strong>
              <p>
                Only users with the <em>Manager</em> role can change monitoring
                levels. Contact your manager to adjust settings.
              </p>
            </div>
          </div>

          <!-- Manager controls -->
          <div id="monitoring-controls">
            <div class="settings-card">
              <h3>Custom Domain Management</h3>
              <p class="setting-desc" style="margin-bottom: 12px">
                Add or remove AI domains to be monitored. (Manager only)
              </p>
              <div style="display: flex; gap: 8px; margin-bottom: 10px">
                <input
                  type="text"
                  id="custom-domain-input"
                  placeholder="Domain (e.g. myai.example.com)"
                  style="
                    flex: 2;
                    padding: 8px;
                    border-radius: 6px;
                    border: 1px solid #d2d2d7;
                  "
                />
                <input
                  type="text"
                  id="custom-domain-name-input"
                  placeholder="Tool Name"
                  style="
                    flex: 2;
                    padding: 8px;
                    border-radius: 6px;
                    border: 1px solid #d2d2d7;
                  "
                />
                <input
                  type="text"
                  id="custom-domain-category-input"
                  placeholder="Category"
                  style="
                    flex: 1;
                    padding: 8px;
                    border-radius: 6px;
                    border: 1px solid #d2d2d7;
                  "
                />
                <button id="add-custom-domain-btn" class="btn btn-primary">
                  Add Domain
                </button>
              </div>
              <div id="custom-domains-list"></div>
            </div>
            <div class="settings-card">
              <h3>Default Monitoring Level</h3>
              <p class="setting-desc" style="margin-bottom: 12px">
                This level applies to all monitored AI websites unless
                overridden below.
              </p>
              <div class="monitoring-level-picker">
                <label class="level-option">
                  <input
                    type="radio"
                    name="default-level"
                    value="lowest"
                    checked
                  />
                  <div class="level-card">
                    <div class="level-title">üü¢ Lowest</div>
                    <div class="level-desc">
                      Logs visits and paste events. No input content scanning.
                    </div>
                  </div>
                </label>
                <label class="level-option">
                  <input type="radio" name="default-level" value="highest" />
                  <div class="level-card">
                    <div class="level-title">üî¥ Highest</div>
                    <div class="level-desc">
                      All basic monitoring plus real-time scanning of input for
                      sensitive data (SSN, credit cards, API keys, etc.).
                    </div>
                  </div>
                </label>
              </div>
            </div>

            <div class="settings-card">
              <h3>Per-Website Overrides</h3>
              <p class="setting-desc" style="margin-bottom: 12px">
                Override the default monitoring level for specific AI websites.
              </p>
              <div id="site-overrides-list" class="site-overrides-list"></div>
              <div class="add-override-row">
                <select id="override-domain-select" class="override-select">
                  <option value="">Select a website‚Ä¶</option>
                </select>
                <select id="override-level-select" class="override-select">
                  <option value="lowest">Lowest</option>
                  <option value="highest">Highest</option>
                </select>
                <button id="add-override-btn" class="btn btn-primary">
                  Add Override
                </button>
              </div>
            </div>

            <!-- Current monitoring level read-only view -->
            <div class="settings-card">
              <h3>Active Monitoring Summary</h3>
              <p class="setting-desc" style="margin-bottom: 12px">
                Below is the effective monitoring level for each tracked
                website.
              </p>
              <div
                id="monitoring-summary-table"
                class="monitoring-summary"
              ></div>
            </div>
          </div>
        </section>

        <!-- Logs Tab -->
        <section id="tab-logs" class="tab-content">
          <div class="page-header">
            <h2>Activity Logs</h2>
            <div class="header-actions">
              <select id="log-type-filter">
                <option value="all">All Events</option>
                <option value="ai_domain_visit">Domain Visits</option>
                <option value="paste_detected">Paste Events</option>
                <option value="user_redirected">Redirects</option>
                <option value="user_continued_unapproved">
                  Continued Unapproved
                </option>
                <option value="ai_input_interaction">Input Interactions</option>
                <option value="sensitive_data_detected">
                  Sensitive Data Alerts
                </option>
              </select>
              <button id="export-btn" class="btn btn-primary">
                üì• Export JSON
              </button>
              <button id="export-csv-btn" class="btn btn-secondary">
                üìÑ Export CSV
              </button>
              <button id="clear-logs-btn" class="btn btn-danger">
                üóëÔ∏è Clear Logs
              </button>
            </div>
          </div>

          <div class="logs-table-wrapper">
            <table class="logs-table">
              <thead>
                <tr>
                  <th>Timestamp</th>
                  <th>Type</th>
                  <th>AI Tool</th>
                  <th>Domain</th>
                  <th>User</th>
                  <th>Details</th>
                </tr>
              </thead>
              <tbody id="logs-tbody">
                <tr>
                  <td colspan="6" class="empty-state">No logs yet.</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <!-- Settings Tab -->
        <section id="tab-settings" class="tab-content">
          <div class="page-header">
            <h2>Settings</h2>
          </div>

          <div class="settings-grid">
            <div class="settings-card">
              <h3>Extension Status</h3>
              <div class="setting-row">
                <div>
                  <label>Enable AI Shield</label>
                  <p class="setting-desc">
                    When disabled, no monitoring or warnings will occur.
                  </p>
                </div>
                <label class="switch">
                  <input type="checkbox" id="setting-enabled" checked />
                  <span class="slider"></span>
                </label>
              </div>
            </div>

            <div class="settings-card">
              <h3>User Identity</h3>
              <div class="setting-row">
                <div class="setting-input-group">
                  <label for="setting-user-name">Name</label>
                  <input
                    type="text"
                    id="setting-user-name"
                    placeholder="Your name"
                  />
                </div>
              </div>
              <div class="setting-row">
                <div class="setting-input-group">
                  <label for="setting-user-role">Role</label>
                  <select id="setting-user-role">
                    <option value="Employee">Employee</option>
                    <option value="Manager">Manager</option>
                    <option value="Developer">Developer</option>
                    <option value="Analyst">Analyst</option>
                    <option value="Executive">Executive</option>
                    <option value="Contractor">Contractor</option>
                    <option value="Other">Other</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="settings-card">
              <h3>Approved AI Redirect</h3>
              <div class="setting-row">
                <div class="setting-input-group">
                  <label for="setting-approved-url">Approved AI URL</label>
                  <input
                    type="url"
                    id="setting-approved-url"
                    placeholder="https://openrouter.ai/"
                  />
                  <p class="setting-desc">
                    Users will be redirected to this URL when choosing the
                    approved AI option.
                  </p>
                </div>
              </div>
            </div>

            <div class="settings-card">
              <h3>Data Management</h3>
              <div class="setting-row">
                <div>
                  <label>Log Storage</label>
                  <p class="setting-desc">
                    Logs are stored locally in the browser. Max 10,000 entries.
                  </p>
                  <p class="setting-desc" id="log-count-display">
                    Current entries: 0
                  </p>
                </div>
                <button id="setting-clear-logs" class="btn btn-danger">
                  Clear All Logs
                </button>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <script src="dashboard.js"></script>
  </body>
</html>
